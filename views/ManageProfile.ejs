<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Monmedecin - Home</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://res.cloudinary.com/dxfq3iotg/raw/upload/v1569006288/BBBootstrap/choices.min.css?version=7.0.0">
  
  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">


</head>

<body>



  <%- include ('navbar.ejs') %>


  <main id="main">

   

   

    <!-- ======= Services Section ======= -->

   <section id="services" class="services"></section>
    <br>
    <div class="container emp-profile">
      <div>
          <div class="row">
              <div class="col-md-4">
                  <div class="profile-img">
                      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS52y5aInsxSm31CvHOFHWujqUx_wWTS9iM6s7BAm21oEN_RiGoog" alt=""/>
                      <div class="file btn btn-lg btn-primary">
                          Change Photo
                          <input type="file" name="file"/>
                      </div>
                  </div>
              </div>
              <div class="col-md-6">
                  <div class="profile-head">
                              <h5>
                                  Mohammed ben ben
                              </h5>
                              <h6>
                                  suivie avec Doc.amrani
                              </h6>
                              <p class="proile-rating"> <span></span></p>
                      <ul class="nav nav-tabs" id="myTab" role="tablist">
                          <li class="nav-item">
                              <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Information generale</a>
                          </li>
                          <li class="nav-item">
                              <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Sécurité</a>
                          </li>
                      </ul>
                  </div>
              </div>
             
          </div>
          <div class="row">
              <div class="col-md-4">
                  <div class="profile-work">
                      <p>Les maladies</p>
                      <a href="">Wxx</a><br/>
                      
                    <!--  <p>SKILLS</p>
                      <a href="">Web Designer</a><br/>
                      <a href="">Web Developer</a><br/>
                      <a href="">WordPress</a><br/>
                      <a href="">WooCommerce</a><br/>
                      <a href="">PHP, .Net</a><br/>-->
                  </div>
              </div>
              <div class="col-md-8">
                  <div class="tab-content profile-tab" id="myTabContent">
                      <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                        <% if (locals.infopatient) { %>          
                        <div class="row">
                                      <div class="col-md-6">
                                          <label>Nom</label>
                                      </div>
                                      <div class="col-md-6">
                                        <input type="text" class="form-control" id="newnom" placeholder="Votre nom exact " value="<%  __append(infopatient[0].Nom) %>" >
                                      </div>
                                  </div>
                                  <br>
                                  <div class="row">
                                      <div class="col-md-6">
                                          <label>Prenom</label>
                                      </div>
                                      <div class="col-md-6">
                                        <input type="text" class="form-control" id="newprenom" placeholder="Votre prénom exact"value="<%  __append(infopatient[0].Prenom) %>" >
                                      </div>
                                  </div>
                                  <br>
                                  <div class="row">
                                      <div class="col-md-6">
                                          <label>Age</label>
                                      </div>
                                      <div class="col-md-6">
                                        <input type="text" class="form-control" id="newage"placeholder="Entrez votre age " value="<%  __append(infopatient[0].Age) %>" >
                                      </div>
                                  </div>
                                  <br>
                                  <div class="row">
                                      <div class="col-md-6">
                                          <label>Téléphone</label>
                                      </div>
                                      <div class="col-md-6">
                                        <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                          <span class="input-group-text">+212</span>
                                        </div>

                                          <input type="text" class="form-control" id="newtelephone" placeholder="Modifer votre numéro " value="<%  __append(infopatient[0].Telephone) %>">
                                        </div>
                                      </div>
                                  </div>

                                  <div class="row">
                                    <div class="col-md-6">
                                        <label>Maladies</label>
                                    </div>
                                   <div class="col-md-6">
                                    <div class="row d-flex justify-content-center mt-100" >
                                      <div class="col-md-12"> 

                                        <select id="maladies"  placeholder="Précisez vos maladies ( si vous en avez )" multiple>
                                          <% if (locals.tabmaladies) { 
  
                                            tabmaladies.forEach( (row) => {
                                              
                                            %>
                                          <option value="<%  __append(row.id) %>"><%  __append(row.nom) %></option>
                                              
                                                                                      
                                            <%  });   %>

                                            <% }  %>
                                              </select> </div>
                                  </div>
                                   </div>
                                </div>

                                   <br>
                                
                                  <div class="row">
                                      <div class="col-md-6">
                                          <label>Mot de passe</label>
                                      </div>
                                      <div class="col-md-6">
                                        <input type="password" class="form-control" id="confpass" placeholder="Votre mot de passe actuelle" >
                                      </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-md-6">
                                      <input type="submit" class="profile-edit-btn" style="margin-left:435px; margin-top:30px;" id="setinfobutton" value="Confirmer"/>
                                  </div>
                                  </div>
                                  <% } %>
                      </div>
                      <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                                  <div class="row">
                                      <div class="col-md-6">
                                          <label>Ancien mot de passe</label>
                                      </div>
                                      <div class="col-md-6">
                                        <input type="password" id="oldpass" class="form-control" placeholder="Ancien mot de passe " >
                                      </div>
                                  </div>
                                  <br>
                                  <div class="row">
                                      <div class="col-md-6">
                                          <label>Nouveau Mot de passe</label>
                                      </div>
                                      <div class="col-md-6">
                                        <input type="password" id="newpass" class="form-control" placeholder="Nouveau mot de passe" >
                                      </div>
                                  </div>
                                  <Br>
                                  <div class="row">
                                      <div class="col-md-6">
                                          <label>Confirmez votre mot de passe</label>
                                      </div>
                                      <div class="col-md-6">
                                        <input type="password" id="confnewpass" class="form-control" placeholder="Confirmez mot de passe" >
                                      </div>
                                  </div>
                                 
                                  <div class="row">
                                  <div class="col-md-6">
                                    <input type="submit" id="btnsecurity" class="profile-edit-btn" style="margin-left:435px; margin-top:30px;" value="Confirmer"/>
                                </div>
                                </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>           
  </div>
  <br> 
  <br>
    </section> <!-- End Services Section -->
  


  </main> <!-- End #main -->
  <%- include ('footer.ejs') %>
  <div id="preloader"></div>
  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/jquery/jquery.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/venobox/venobox.min.js"></script>
  <script src="assets/vendor/waypoints/jquery.waypoints.min.js"></script>
  <script src="assets/vendor/counterup/counterup.min.js"></script>
  <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="assets/vendor/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>

  <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="https://res.cloudinary.com/dxfq3iotg/raw/upload/v1569006273/BBBootstrap/choices.min.js?version=7.0.0"></script>
<script>
  var expanded = false;

function showCheckboxes() {
  var checkboxes = document.getElementById("checkboxes");
  if (!expanded) {
    checkboxes.style.display = "block";
    expanded = true;
  } else {
    checkboxes.style.display = "none";
    expanded = false;
  }
}
</script>
  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script> 
    $(document).ready(function(){
        $("#btnsecurity").click(function(){
          console.log("button clicked");
          Oldpass = $('#oldpass').val();
          Newpass = $('#newpass').val();
          confnewpass = $('#confnewpass').val();
      if(Newpass == confnewpass)
      {
        console.log("ajax")
          $.ajax({
            url : "/changepass",
            data :{
              oldpass : Oldpass,
              newpass : Newpass
            },
            method:"POST",
            success : function (res) {
              console.log(res)
          if(res==true)
            alert("Mot de passe a été changer avec success")
            else
            alert("Mot de passe incorrect")

              }
          })
        }
          else
           alert("Mot de passe de confirmation incorrect")
           
        });
        $("#setinfobutton").click(function(){
          console.log("button clicked setinfo");
          Newnom = $('#newnom').val();
          Newprenom = $('#newprenom').val();
          Newtelephone = $('#newtelephone').val();
          Newage = $('#newage').val();
          selectmaladies = document.getElementById('maladies');
          selectedoptions = Array.from(selectmaladies.selectedOptions);
          confpass = $('#confpass').val();
      
          selectarray = new Array(); 
          selectedoptions.forEach(element => {
            selectarray.push(element.value);
            
          });
          console.log(selectarray);
          $.ajax({
            url : "/changeinfo",
            data :{
              password : confpass,
              nom : Newnom,
              prenom : Newprenom,
              age : Newage,
              telephone : Newtelephone,
              maladies : selectarray
            },
            method:"POST",
            success : function (res) {
              console.log(res)
          if(res==true)
            alert("Information changé avec success ")
            else
            alert("Mot de passe incorrect")

              }
          })
        
        });
    });
  </script>

<script>
  $(document).ready(function(){

var multipleCancelButton = new Choices('#maladies', {
removeItemButton: true
});


});
</script>
</body>
</html>